package conf

import (
	"context"

	"google.golang.org/grpc"
	"google.golang.org/grpc/metadata"
)

func GetTronGrpcNode() string {
	if cfg.TronGrpcNode != "" {

		return cfg.TronGrpcNode
	}

	return defaultTronGrpcNode
}

func GetTronApiKey() string {
	return cfg.TronApiKey
}

// GetTronGrpcDialOptions 返回 TRON GRPC 连接的额外选项（包含 API Key）
func GetTronGrpcDialOptions() []grpc.DialOption {
	var opts []grpc.DialOption
	apiKey := GetTronApiKey()
	if apiKey != "" {
		opts = append(opts, grpc.WithUnaryInterceptor(func(ctx context.Context, method string, req, reply interface{}, cc *grpc.ClientConn, invoker grpc.UnaryInvoker, opts ...grpc.CallOption) error {
			ctx = metadata.AppendToOutgoingContext(ctx, "TRON-PRO-API-KEY", apiKey)
			return invoker(ctx, method, req, reply, cc, opts...)
		}))
	}
	return opts
}

func GetAptosRpcNode() string {
	if cfg.AptosRpcNode != "" {
		return cfg.AptosRpcNode
	}

	return defaultAptosRpcEndpoint
}

func GetSolanaRpcEndpoint() string {
	if cfg.EvmRpc.Solana != "" {

		return cfg.EvmRpc.Solana
	}

	return defaultSolanaRpcEndpoint
}

func GetXlayerRpcEndpoint() string {
	if cfg.EvmRpc.Xlayer != "" {

		return cfg.EvmRpc.Xlayer
	}

	return defaultXlayerRpcEndpoint
}

func GetBscRpcEndpoint() string {
	if cfg.EvmRpc.Bsc != "" {

		return cfg.EvmRpc.Bsc
	}

	return defaultBscRpcEndpoint
}

func GetPolygonRpcEndpoint() string {
	if cfg.EvmRpc.Polygon != "" {

		return cfg.EvmRpc.Polygon
	}

	return defaultPolygonRpcEndpoint
}

func GetArbitrumRpcEndpoint() string {
	if cfg.EvmRpc.Arbitrum != "" {

		return cfg.EvmRpc.Arbitrum
	}

	return defaultArbitrumRpcEndpoint
}

func GetPlasmaRpcEndpoint() string {
	if cfg.EvmRpc.Plasma != "" {

		return cfg.EvmRpc.Plasma
	}

	return defaultPlasmaRpcEndpoint
}

func GetEthereumRpcEndpoint() string {
	if cfg.EvmRpc.Ethereum != "" {

		return cfg.EvmRpc.Ethereum
	}

	return defaultEthereumRpcEndpoint
}

func GetBaseRpcEndpoint() string {
	if cfg.EvmRpc.Base != "" {

		return cfg.EvmRpc.Base
	}

	return defaultBaseRpcEndpoint
}
